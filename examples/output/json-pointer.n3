@prefix ex: <http://example.org/> .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   ex:checks ex:firstUserNameOk true .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users/0/profile~1name") string:jsonPointer "Ada Lovelace" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/users/0/profile~1name") string:jsonPointer "Ada Lovelace" .
#   } => {
#     ex:checks ex:firstUserNameOk true .
#   } .
# with substitution (on rule variables):
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

ex:checks ex:firstUserNameOk true .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u1> a ex:AllowedUser .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (0 """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/id") string:jsonPointer "u1" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/email") string:jsonPointer "ada@example.org" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Ada Lovelace" .
#   ("ada@example.org" "@([^@]+)$") string:scrape "example.org" .
#   ("example.org" "example.com") list:member "example.org" .
#   ("urn:example:user:%s" "u1") string:format "urn:example:user:u1" .
#   <urn:example:user:u1> log:uri "urn:example:user:u1" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ?Allowed list:member ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#   } => {
#     ?User a ex:AllowedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "ada@example.org"
#   ?EmailDomain = "example.org"
#   ?Id = "u1"
#   ?Idx = 0
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Ada Lovelace"
#   ?UriStr = "urn:example:user:u1"
#   ?User = <urn:example:user:u1>
#   ?UserJson = """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u1> a ex:AllowedUser .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u1> ex:name "Ada Lovelace" .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (0 """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/id") string:jsonPointer "u1" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/email") string:jsonPointer "ada@example.org" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Ada Lovelace" .
#   ("ada@example.org" "@([^@]+)$") string:scrape "example.org" .
#   ("example.org" "example.com") list:member "example.org" .
#   ("urn:example:user:%s" "u1") string:format "urn:example:user:u1" .
#   <urn:example:user:u1> log:uri "urn:example:user:u1" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ?Allowed list:member ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#   } => {
#     ?User a ex:AllowedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "ada@example.org"
#   ?EmailDomain = "example.org"
#   ?Id = "u1"
#   ?Idx = 0
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Ada Lovelace"
#   ?UriStr = "urn:example:user:u1"
#   ?User = <urn:example:user:u1>
#   ?UserJson = """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u1> ex:name "Ada Lovelace" .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u1> ex:email "ada@example.org" .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (0 """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/id") string:jsonPointer "u1" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/email") string:jsonPointer "ada@example.org" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Ada Lovelace" .
#   ("ada@example.org" "@([^@]+)$") string:scrape "example.org" .
#   ("example.org" "example.com") list:member "example.org" .
#   ("urn:example:user:%s" "u1") string:format "urn:example:user:u1" .
#   <urn:example:user:u1> log:uri "urn:example:user:u1" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ?Allowed list:member ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#   } => {
#     ?User a ex:AllowedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "ada@example.org"
#   ?EmailDomain = "example.org"
#   ?Id = "u1"
#   ?Idx = 0
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Ada Lovelace"
#   ?UriStr = "urn:example:user:u1"
#   ?User = <urn:example:user:u1>
#   ?UserJson = """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u1> ex:email "ada@example.org" .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u1> ex:emailDomain "example.org" .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (0 """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/id") string:jsonPointer "u1" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/email") string:jsonPointer "ada@example.org" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Ada Lovelace" .
#   ("ada@example.org" "@([^@]+)$") string:scrape "example.org" .
#   ("example.org" "example.com") list:member "example.org" .
#   ("urn:example:user:%s" "u1") string:format "urn:example:user:u1" .
#   <urn:example:user:u1> log:uri "urn:example:user:u1" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ?Allowed list:member ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#   } => {
#     ?User a ex:AllowedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "ada@example.org"
#   ?EmailDomain = "example.org"
#   ?Id = "u1"
#   ?Idx = 0
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Ada Lovelace"
#   ?UriStr = "urn:example:user:u1"
#   ?User = <urn:example:user:u1>
#   ?UserJson = """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u1> ex:emailDomain "example.org" .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u1> ex:userIndex 0 .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (0 """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/id") string:jsonPointer "u1" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/email") string:jsonPointer "ada@example.org" .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Ada Lovelace" .
#   ("ada@example.org" "@([^@]+)$") string:scrape "example.org" .
#   ("example.org" "example.com") list:member "example.org" .
#   ("urn:example:user:%s" "u1") string:format "urn:example:user:u1" .
#   <urn:example:user:u1> log:uri "urn:example:user:u1" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ?Allowed list:member ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#   } => {
#     ?User a ex:AllowedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "ada@example.org"
#   ?EmailDomain = "example.org"
#   ?Id = "u1"
#   ?Idx = 0
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Ada Lovelace"
#   ?UriStr = "urn:example:user:u1"
#   ?User = <urn:example:user:u1>
#   ?UserJson = """{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u1> ex:userIndex 0 .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u2> a ex:BlockedUser .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (1 """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/id") string:jsonPointer "u2" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/email") string:jsonPointer "bob@evil.invalid" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Bob Mallory" .
#   ("bob@evil.invalid" "@([^@]+)$") string:scrape "evil.invalid" .
#   ("urn:example:user:%s" "u2") string:format "urn:example:user:u2" .
#   <urn:example:user:u2> log:uri "urn:example:user:u2" .
#   ("example.org" "example.com") list:notMember "evil.invalid" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#     ?Allowed list:notMember ?EmailDomain .
#   } => {
#     ?User a ex:BlockedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "bob@evil.invalid"
#   ?EmailDomain = "evil.invalid"
#   ?Id = "u2"
#   ?Idx = 1
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Bob Mallory"
#   ?UriStr = "urn:example:user:u2"
#   ?User = <urn:example:user:u2>
#   ?UserJson = """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u2> a ex:BlockedUser .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u2> ex:name "Bob Mallory" .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (1 """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/id") string:jsonPointer "u2" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/email") string:jsonPointer "bob@evil.invalid" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Bob Mallory" .
#   ("bob@evil.invalid" "@([^@]+)$") string:scrape "evil.invalid" .
#   ("urn:example:user:%s" "u2") string:format "urn:example:user:u2" .
#   <urn:example:user:u2> log:uri "urn:example:user:u2" .
#   ("example.org" "example.com") list:notMember "evil.invalid" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#     ?Allowed list:notMember ?EmailDomain .
#   } => {
#     ?User a ex:BlockedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "bob@evil.invalid"
#   ?EmailDomain = "evil.invalid"
#   ?Id = "u2"
#   ?Idx = 1
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Bob Mallory"
#   ?UriStr = "urn:example:user:u2"
#   ?User = <urn:example:user:u2>
#   ?UserJson = """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u2> ex:name "Bob Mallory" .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u2> ex:email "bob@evil.invalid" .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (1 """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/id") string:jsonPointer "u2" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/email") string:jsonPointer "bob@evil.invalid" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Bob Mallory" .
#   ("bob@evil.invalid" "@([^@]+)$") string:scrape "evil.invalid" .
#   ("urn:example:user:%s" "u2") string:format "urn:example:user:u2" .
#   <urn:example:user:u2> log:uri "urn:example:user:u2" .
#   ("example.org" "example.com") list:notMember "evil.invalid" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#     ?Allowed list:notMember ?EmailDomain .
#   } => {
#     ?User a ex:BlockedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "bob@evil.invalid"
#   ?EmailDomain = "evil.invalid"
#   ?Id = "u2"
#   ?Idx = 1
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Bob Mallory"
#   ?UriStr = "urn:example:user:u2"
#   ?User = <urn:example:user:u2>
#   ?UserJson = """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u2> ex:email "bob@evil.invalid" .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u2> ex:emailDomain "evil.invalid" .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (1 """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/id") string:jsonPointer "u2" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/email") string:jsonPointer "bob@evil.invalid" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Bob Mallory" .
#   ("bob@evil.invalid" "@([^@]+)$") string:scrape "evil.invalid" .
#   ("urn:example:user:%s" "u2") string:format "urn:example:user:u2" .
#   <urn:example:user:u2> log:uri "urn:example:user:u2" .
#   ("example.org" "example.com") list:notMember "evil.invalid" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#     ?Allowed list:notMember ?EmailDomain .
#   } => {
#     ?User a ex:BlockedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "bob@evil.invalid"
#   ?EmailDomain = "evil.invalid"
#   ?Id = "u2"
#   ?Idx = 1
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Bob Mallory"
#   ?UriStr = "urn:example:user:u2"
#   ?User = <urn:example:user:u2>
#   ?UserJson = """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u2> ex:emailDomain "evil.invalid" .

# ----------------------------------------------------------------------
# Proof for derived triple:
#   <urn:example:user:u2> ex:userIndex 1 .
# It holds because the following instance of the rule body is provable:
#   ex:doc ex:json "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/policy/allowedDomains") string:jsonPointer ("example.org" "example.com") .
#   ("{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON "/users") string:jsonPointer ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) list:iterate (1 """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON) .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/id") string:jsonPointer "u2" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/email") string:jsonPointer "bob@evil.invalid" .
#   ("""{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON "/profile~1name") string:jsonPointer "Bob Mallory" .
#   ("bob@evil.invalid" "@([^@]+)$") string:scrape "evil.invalid" .
#   ("urn:example:user:%s" "u2") string:format "urn:example:user:u2" .
#   <urn:example:user:u2> log:uri "urn:example:user:u2" .
#   ("example.org" "example.com") list:notMember "evil.invalid" .
# via the schematic forward rule:
#   {
#     ex:doc ex:json ?J .
#     (?J "/policy/allowedDomains") string:jsonPointer ?Allowed .
#     (?J "/users") string:jsonPointer ?Users .
#     ?Users list:iterate (?Idx ?UserJson) .
#     (?UserJson "/id") string:jsonPointer ?Id .
#     (?UserJson "/email") string:jsonPointer ?Email .
#     (?UserJson "/profile~1name") string:jsonPointer ?Name .
#     (?Email "@([^@]+)$") string:scrape ?EmailDomain .
#     ("urn:example:user:%s" ?Id) string:format ?UriStr .
#     ?User log:uri ?UriStr .
#     ?Allowed list:notMember ?EmailDomain .
#   } => {
#     ?User a ex:BlockedUser .
#     ?User ex:name ?Name .
#     ?User ex:email ?Email .
#     ?User ex:emailDomain ?EmailDomain .
#     ?User ex:userIndex ?Idx .
#   } .
# with substitution (on rule variables):
#   ?Allowed = ("example.org" "example.com")
#   ?Email = "bob@evil.invalid"
#   ?EmailDomain = "evil.invalid"
#   ?Id = "u2"
#   ?Idx = 1
#   ?J = "{\n  \"users\": [\n    { \"id\": \"u1\", \"email\": \"ada@example.org\",     \"profile/name\": \"Ada Lovelace\" },\n    { \"id\": \"u2\", \"email\": \"bob@evil.invalid\",    \"profile/name\": \"Bob Mallory\" }\n  ],\n  \"policy\": { \"allowedDomains\": [\"example.org\", \"example.com\"] }\n}"^^rdf:JSON
#   ?Name = "Bob Mallory"
#   ?UriStr = "urn:example:user:u2"
#   ?User = <urn:example:user:u2>
#   ?UserJson = """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON
#   ?Users = ("""{"id":"u1","email":"ada@example.org","profile/name":"Ada Lovelace"}"""^^rdf:JSON """{"id":"u2","email":"bob@evil.invalid","profile/name":"Bob Mallory"}"""^^rdf:JSON)
# Therefore the derived triple above is entailed by the rules and facts.
# ----------------------------------------------------------------------

<urn:example:user:u2> ex:userIndex 1 .

